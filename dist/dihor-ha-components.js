var r="/* KARTA */\r\n.dihor-card {\r\n  margin: 0;\r\n  width: 100%;\r\n  background: var(--dihor-card-bg);\r\n  backdrop-filter: blur(20px);\r\n  border-radius: var(--dihor-card-border-radius);\r\n  box-sizing: border-box;\r\n  padding: 18px;\r\n  box-shadow: var(--dihor-card-shadow);\r\n  border: var(--dihor-card-border-size) solid var(--dihor-card-border-color);\r\n  font-family: sans-serif;\r\n}\r\n";class n extends HTMLElement{constructor(){super(...arguments),this._contentCreated=!1}setConfig(r){this._config=r}set hass(n){this._hass=n,this._contentCreated||(this.innerHTML=`\n        <style>/* Style variables for dihor cards */\r\n.dihor-theme-light {\r\n  --dihor-card-bg: rgba(255, 255, 255, 0.95);\r\n  --dihor-card-border-size: 1px;\r\n  --dihor-card-border-radius: 12px;\r\n  --dihor-card-border-color: rgba(255, 255, 255, 0.2);\r\n  --dihor-card-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);\r\n\r\n  --dihor-title-color: #1d1d1f;\r\n  --dihor-subtitle-color: #666;\r\n  --dihor-stat-bg: rgba(200, 200, 200, 0.2);\r\n\r\n  --dihor-badge-online-bg: #4caf50;\r\n  --dihor-badge-offline-bg: #ff3b30;\r\n  --dihor-badge-players-bg: #9c27b0;\r\n  --dihor-badge-version-bg: #007aff;\r\n  --dihor-badge-latency-bg: #ff9500;\r\n\r\n  --dihor-divider-color: rgba(0, 0, 0, 0.08);\r\n}\r\n\r\n.dihor-theme-dark {\r\n  --dihor-card-bg: rgba(48, 48, 48, 0.95);\r\n  --dihor-card-border-size: 1px;\r\n  --dihor-card-border-radius: 12px;\r\n  --dihor-card-border-color: rgba(255, 255, 255, 0.1);\r\n  --dihor-card-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);\r\n\r\n  --dihor-title-color: #f3f3f3;\r\n  --dihor-subtitle-color: #aaa;\r\n  --dihor-stat-bg: rgba(80, 80, 80, 0.5);\r\n\r\n  --dihor-badge-online-bg: #4caf50;\r\n  --dihor-badge-offline-bg: #ff3b30;\r\n  --dihor-badge-players-bg: #9c27b0;\r\n  --dihor-badge-version-bg: #007aff;\r\n  --dihor-badge-latency-bg: #ff9500;\r\n\r\n  --dihor-divider-color: rgba(255, 255, 255, 0.1);\r\n}\r\n${r}</style>\n        ${this.additionalCss()}\n        <ha-card>\n          ${this.cardHtml()}\n          ${this.cardCss()?`<style>${this.cardCss()}</style>`:""}\n        </ha-card>\n      `,this._card=this.querySelector("ha-card")||void 0,this._contentCreated=!0,this.onCardCreated()),this.applyTheme(),this.update(n)}get hass(){return this._hass}get card(){return this._card||this}applyTheme(){var r,n;const e=this.querySelector("ha-card"),t=document.querySelector("home-assistant"),i=null===(n=null===(r=null==t?void 0:t.hass)||void 0===r?void 0:r.themes)||void 0===n?void 0:n.darkMode;e&&(e.classList.toggle("dihor-theme-dark",!!i),e.classList.toggle("dihor-theme-light",!i))}additionalCss(){return""}cardCss(){return""}onCardCreated(){}update(r){}}class e extends n{setConfig(r){if(!r.entity)throw new Error("Entity is required");super.setConfig(r)}cardHtml(){return'\n      <div class="card-content">\n        <img style="width:100%;border-radius:50%" />\n      </div>\n    '}update(r){const n=r.states[this._config.entity];if(!n)return;const e=n.attributes.friendly_name||this._config.entity,t=n.attributes.entity_picture,i=this.querySelector("ha-card");i&&i.setAttribute("header",e);const a=this.querySelector("img");a&&t&&(a.setAttribute("src",t),a.setAttribute("alt",e))}getCardSize(){return 1}}customElements.get("dihor-person-card")||customElements.define("dihor-person-card",e),window.customCards=window.customCards||[],window.customCards.push({type:"dihor-person-card",name:"Dihor Person Card",preview:!0,description:"Displays Home Assistant person entity"});class t extends n{setConfig(r){if(!r.entity_prefix)throw new Error("entity_prefix is required");(r.entity_prefix.startsWith("sensor.")||r.entity_prefix.startsWith("binary_sensor."))&&console.warn('[dihor-minecraft-card] entity_prefix should not include "sensor." or "binary_sensor."'),super.setConfig(r)}additionalCss(){return`<style>${r}</style>`}cardHtml(){return'<div class="dihor-card dihor-theme-light">\r\n  <div class="dihor-card-header">\r\n    <div class="dihor-header-row">\r\n      <h1 class="dihor-card-title">My Minecraft Server</h1>\r\n      <span id="version" class="dihor-badge dihor-badge-version">0.0.0</span>\r\n    </div>\r\n    <div id="motd" class="dihor-card-subtitle">message of the day</div>\r\n  </div>\r\n\r\n  <ul class="dihor-grid-3">\r\n    <li class="dihor-stat">\r\n      <div class="dihor-stat-icon">ðŸ”Œ</div>\r\n      <div class="dihor-stat-label">Status</div>\r\n      <div class="dihor-stat-value">\r\n        <span id="status" class="dihor-badge dihor-badge-offline">Offline</span>\r\n      </div>\r\n    </li>\r\n\r\n    <li class="dihor-stat">\r\n      <div class="dihor-stat-icon">ðŸ‘¥</div>\r\n      <div class="dihor-stat-label">Players</div>\r\n      <div class="dihor-stat-value">\r\n        <span id="players" class="dihor-badge dihor-badge-players">0/0</span>\r\n      </div>\r\n    </li>\r\n\r\n    <li class="dihor-stat">\r\n      <div class="dihor-stat-icon">âš¡</div>\r\n      <div class="dihor-stat-label">Ping</div>\r\n      <div class="dihor-stat-value">\r\n        <span id="latency" class="dihor-badge dihor-badge-latency">0</span>\r\n      </div>\r\n    </li>\r\n  </ul>\r\n</div>\r\n'}cardCss(){return"/* NAGÅÃ“WEK */\r\n.dihor-card-header {\r\n  margin-bottom: 16px;\r\n  padding-bottom: 12px;\r\n  border-bottom: 1px solid var(--dihor-divider-color);\r\n}\r\n\r\n.dihor-header-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.dihor-card-title {\r\n  font-size: 20px;\r\n  font-weight: 700;\r\n  color: var(--dihor-title-color);\r\n  margin: 0;\r\n}\r\n\r\n.dihor-card-subtitle {\r\n  font-size: 14px;\r\n  color: var(--dihor-subtitle-color);\r\n  font-weight: 500;\r\n}\r\n\r\n/* SIATKA STATYSTYK */\r\n.dihor-grid-3 {\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr 1fr;\r\n  gap: 12px;\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n\r\n/* POJEDYNCZA STATYSTYKA */\r\n.dihor-stat {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 10px 0;\r\n  background: var(--dihor-stat-bg);\r\n  border-radius: var(--dihor-card-border-radius);\r\n  text-align: center;\r\n}\r\n\r\n.dihor-stat-icon {\r\n  font-size: 18px;\r\n}\r\n\r\n.dihor-stat-label {\r\n  font-size: 11px;\r\n  color: var(--dihor-subtitle-color);\r\n  font-weight: 500;\r\n  margin-bottom: 4px;\r\n  text-transform: uppercase;\r\n  letter-spacing: 0.5px;\r\n}\r\n\r\n.dihor-stat-value {\r\n  font-size: 14px;\r\n  color: var(--dihor-title-color);\r\n  font-weight: 600;\r\n  line-height: 1.2;\r\n}\r\n\r\n/* BADGES */\r\n.dihor-badge {\r\n  font-size: 12px;\r\n  padding: 4px 8px;\r\n  border-radius: 12px;\r\n  font-weight: 600;\r\n  color: white;\r\n}\r\n\r\n.dihor-badge-online {\r\n  background: var(--dihor-badge-online-bg);\r\n}\r\n\r\n.dihor-badge-offline {\r\n  background: var(--dihor-badge-offline-bg);\r\n}\r\n\r\n.dihor-badge-players {\r\n  background: var(--dihor-badge-players-bg);\r\n}\r\n\r\n.dihor-badge-version {\r\n  background: var(--dihor-badge-version-bg);\r\n}\r\n\r\n.dihor-badge-latency {\r\n  background: var(--dihor-badge-latency-bg);\r\n}\r\n"}update(r){const n=this._config.entity_prefix,e=e=>{var t,i,a,s,o,d;return null!==(d=null!==(s=null!==(i=null===(t=r.states[`${n}${e}`])||void 0===t?void 0:t.state)&&void 0!==i?i:null===(a=r.states[`sensor.${n}${e}`])||void 0===a?void 0:a.state)&&void 0!==s?s:null===(o=r.states[`binary_sensor.${n}${e}`])||void 0===o?void 0:o.state)&&void 0!==d?d:"unavailable"},t=(r,n)=>{const e=this.querySelector(`#${r}`);e&&(e.textContent=n)},i=e("_status").toLowerCase(),a="unavailable"===i||"offline"===i||"0"===i,s=a?"":e("_world_message"),o=a?"0.0.0":e("_version"),d=a?"0":e("_players_online"),l=a?"0":e("_players_max"),c=(a?"0":e("_latency")).split(".")[0];t("motd",s),t("version",o),t("status",a?"Offline":"Online"),t("players",`${d} / ${l}`),t("latency",c);const h=this.querySelector("#status");h&&(h.className="dihor-badge "+(a?"dihor-badge-offline":"dihor-badge-online"))}getCardSize(){return 1}}customElements.get("dihor-minecraft-card")||customElements.define("dihor-minecraft-card",t),window.customCards=window.customCards||[],window.customCards.push({type:"dihor-minecraft-card",name:"Dihor Minecraft Card",preview:!0,description:"Monitor a Minecraft server via sensor entities"});class i extends n{connectedCallback(){this.startClock()}disconnectedCallback(){this._interval&&window.clearInterval(this._interval)}cardHtml(){return'<div class="dihor-card dihor-theme-light">\r\n  <div class="dihor-digital-clock">\r\n    <div id="time">00:00:00</div>\r\n  </div>\r\n</div>\r\n'}cardCss(){return".dihor-digital-clock {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  font-size: 2.5rem;\r\n  font-weight: 600;\r\n  padding: 1rem 0;\r\n  color: var(--dihor-title-color);\r\n}\r\n"}onCardCreated(){this.startClock()}startClock(){this.updateTime(),this._interval&&window.clearInterval(this._interval),this._interval=window.setInterval(()=>this.updateTime(),1e3)}updateTime(){const r=(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),n=this.querySelector("#time");n&&(n.textContent=r)}getCardSize(){var r;return null!==(r=this._config.size)&&void 0!==r?r:2}}customElements.get("dihor-clock-card")||customElements.define("dihor-clock-card",i),window.customCards=window.customCards||[],window.customCards.push({type:"dihor-clock-card",name:"Dihor Clock Card",preview:!0,description:"Minimal digital clock card with configurable size"});const a="dihor-dashboard-background-last-unsplash";class s extends n{constructor(){super(...arguments),this._appliedProps=new Set,this._prevStyles=new Map,this._unsplashStatus="brak"}setConfig(r){super.setConfig(r),this.applyBackground(),this.renderConfigSummary()}cardHtml(){return'<div class="dashboard-background-card">\n  <div class="intro">\n    <p class="heading">Tlo dashboard</p>\n    <p class="description">Ustawienia tla zostana przejete przez widok, w ktorym karta sie znajduje.</p>\n  </div>\n  <div class="values">\n    <p><span class="label">Kolor</span><span class="value" data-config-color>domyslny</span></p>\n    <p><span class="label">Obraz</span><span class="value" data-config-image>brak</span></p>\n    <p><span class="label">Gradient</span><span class="value" data-config-gradient>brak</span></p>\n    <p><span class="label">Unsplash</span><span class="value" data-config-unsplash>brak</span></p>\n    <p><span class="label">Status Unsplash</span><span class="value" data-config-unsplash-status>brak</span></p>\n  </div>\n</div>\r\n'}cardCss(){return".dashboard-background-card {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.dashboard-background-card .intro {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n.dashboard-background-card .heading {\n  font-size: 1.1rem;\n  font-weight: 600;\n  margin: 0;\n}\n.dashboard-background-card .description {\n  margin: 0;\n  color: rgba(0, 0, 0, 0.65);\n}\n.dashboard-background-card .values {\n  display: grid;\n  grid-template-columns: auto 1fr;\n  gap: 4px 8px;\n  font-size: 0.9rem;\n}\n.dashboard-background-card .label {\n  font-weight: 600;\n  color: rgba(0, 0, 0, 0.55);\n}\n.dashboard-background-card .value {\n  text-align: right;\n  color: rgba(0, 0, 0, 0.8);\n}\r\n"}onCardCreated(){this.applyBackground(),this.renderConfigSummary()}update(){this.applyBackground(),this.renderConfigSummary()}disconnectedCallback(){this.restoreView()}renderConfigSummary(){var r,n,e,t,i,a,s;const o=(r,n)=>{const e=this.querySelector(r);e&&(e.textContent=n||"brak")};o("[data-config-color]",null===(r=this._config)||void 0===r?void 0:r.color),o("[data-config-image]",null===(n=this._config)||void 0===n?void 0:n.image),o("[data-config-gradient]",null===(e=this._config)||void 0===e?void 0:e.gradient),o("[data-config-unsplash]",(null===(i=null===(t=this._config)||void 0===t?void 0:t.unsplash)||void 0===i?void 0:i.category)||(null===(s=null===(a=this._config)||void 0===a?void 0:a.unsplash)||void 0===s?void 0:s.query)),o("[data-config-unsplash-status]",this._unsplashStatus)}async applyBackground(){const r=this.findView();if(!r)return;this._viewElement&&this._viewElement!==r&&this.restoreView(),this._viewElement=r;const n=await this.buildBackgroundStyle();if(!n)return this.clearAppliedStyles(),void this.renderConfigSummary();this.syncStyle(n),this.renderConfigSummary()}syncStyle(r){if(this._viewElement){for(const n of Array.from(this._appliedProps))n in r||(this.restoreProperty(n),this._appliedProps.delete(n));for(const[n,e]of Object.entries(r))this._prevStyles.has(n)||this._prevStyles.set(n,this._viewElement.style.getPropertyValue(n)),this._viewElement.style.setProperty(n,e),this._appliedProps.add(n)}}restoreProperty(r){if(!this._viewElement)return;const n=this._prevStyles.get(r);n?this._viewElement.style.setProperty(r,n):this._viewElement.style.removeProperty(r),this._prevStyles.delete(r)}clearAppliedStyles(){if(this._viewElement){for(const r of Array.from(this._appliedProps))this.restoreProperty(r);this._appliedProps.clear(),this._prevStyles.clear()}}restoreView(){this.clearAppliedStyles(),this._viewElement=void 0}async buildBackgroundStyle(){const r=this._config;if(!r)return null;const n={};r.transition&&(n.transition=r.transition);const e=[];r.gradient&&e.push(r.gradient);const t=await this.resolveBackgroundImage();return t&&e.push(`url("${this.safeUrl(t)}")`),e.length&&(n.backgroundImage=e.join(", ")),r.color&&(n.backgroundColor=r.color),r.position&&(n.backgroundPosition=r.position),r.size&&(n.backgroundSize=r.size),r.repeat&&(n.backgroundRepeat=r.repeat),r.blend_mode&&(n.backgroundBlendMode=r.blend_mode),r.attachment&&(n.backgroundAttachment=r.attachment),Object.keys(n).length?n:null}async resolveBackgroundImage(){if(!this._config)return;if(this._config.image)return this._unsplashStatus="nadpisane",this._config.image;const r=this._config.unsplash;if(!r)return void(this._unsplashStatus="brak");const n=await this.fetchUnsplashImage(r);if(n)return this._unsplashStatus="pobrano",this.saveCachedUnsplashImage(n),n;const e=this.loadCachedUnsplashImage();if(e)return this._unsplashStatus="ostatnie",e;this._unsplashStatus="blad"}async fetchUnsplashImage(r){var n,e,t,i,a;const s=(null===(n=null==r?void 0:r.category)||void 0===n?void 0:n.trim())||(null===(e=null==r?void 0:r.query)||void 0===e?void 0:e.trim());if(!s)return null;const o=new URLSearchParams({query:s,content_filter:"high",w:"1920"});(null==r?void 0:r.orientation)&&o.set("orientation",r.orientation);const d=`https://api.unsplash.com/photos/random?${o.toString()}`,l={};(null==r?void 0:r.api_key)&&(l.Authorization=`Client-ID ${r.api_key.trim()}`);try{const r=await fetch(d,{headers:l});if(!r.ok)return null;const n=await r.json(),e=(null===(t=null==n?void 0:n.urls)||void 0===t?void 0:t.regular)||(null===(i=null==n?void 0:n.urls)||void 0===i?void 0:i.full)||(null===(a=null==n?void 0:n.urls)||void 0===a?void 0:a.raw);if("string"==typeof e&&e)return e}catch(r){}return null}saveCachedUnsplashImage(r){try{window.localStorage.setItem(a,r)}catch(r){}}loadCachedUnsplashImage(){try{return window.localStorage.getItem(a)||void 0}catch(r){return}}safeUrl(r){const n=r.trim();return n?n.replace(/"/g,'\\"'):""}findView(){let r=this;for(;r;){if(r instanceof HTMLElement&&"hui-view"===r.tagName.toLowerCase())return r;r=r instanceof ShadowRoot?r.host:r.parentNode}return null}getCardSize(){return 2}}customElements.get("dihor-dashboard-background-card")||customElements.define("dihor-dashboard-background-card",s),window.customCards=window.customCards||[],window.customCards.push({type:"dihor-dashboard-background-card",name:"Dihor Dashboard Background Card",preview:!0,description:"Take over the view background using a configured color, gradient or image."});export{i as ClockCard,s as DashboardBackgroundCard,t as MinecraftCard,e as PersonCard};
